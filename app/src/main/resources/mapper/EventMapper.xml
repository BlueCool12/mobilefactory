<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mobilefactory.infrastructure.persistence.mapper.EventMapper">

  <select id="findActiveEvent" resultType="mobilefactory.infrastructure.persistence.entity.EventEntity">
    SELECT * FROM EVENT
    WHERE start_date &lt;= #{now} AND announcement_end &gt;= #{now}
    ORDER BY start_date DESC
    LIMIT 1
  </select>

  <insert id="insert" useGeneratedKeys="true" keyProperty="id">
    INSERT INTO EVENT (name, start_date, end_date, announcement_start, announcement_end, max_participants, winning_numbers, pre_assigned_phone)
    VALUES (#{name}, #{startDate}, #{endDate}, #{announcementStart}, #{announcementEnd}, #{maxParticipants}, #{winningNumbers}, #{preAssignedPhone})
  </insert>

</mapper>
